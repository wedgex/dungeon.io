<html>
	<head>
		<script src="/socket.io/socket.io.js"></script>
		<script src="/js/underscore-min.js"></script>
	</head>
	<body>
		<script>
		  var socket = io.connect("/");
		  var players = [];

		  var redrawPlayerList = function() {
		  	var playersList = document.getElementById('players');
		  	playersList.innerHTML = "";

		  	players.forEach(function(player) {		  		
		  		var li = document.createElement("li"),
		  			  playerText = document.createTextNode(player.name);

		  		li.appendChild(playerText);
		  		playersList.appendChild(li);
		  	});
		  };

		  socket.on("connect", function() {
		  	var name = prompt("Enter your character's name");
		  	socket.emit('player join', name);
		  });

		  socket.on("player joined", function(player) {
		  	players.push(player);
		  	
		  	// TODO hook this up with an event
		  	redrawPlayerList();
		  });

		  socket.on("player left", function(playerThatLeft) {
		  	players = _.reject(players, function(player) {
		  		return player.id == playerThatLeft.id;
		  	});

		  	redrawPlayerList();
		  });

		</script>
		<ul id="players"></ul>
	</body>
</html>